<div class="admin-orders">
  <!-- Header Section -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-info">
        <h1 class="page-title">
          <mat-icon>receipt_long</mat-icon>
          Order Management
        </h1>
        <p class="page-subtitle">Monitor and manage all platform orders</p>
      </div>
      <div class="header-actions">
        <button mat-icon-button (click)="loadOrders()" matTooltip="Refresh Data" class="refresh-btn">
          <mat-icon>refresh</mat-icon>
        </button>
      </div>
    </div>
  </div>

  <!-- Filter Section -->
  <div class="filter-section">
    <div class="filter-card">
      <div class="filter-content">
        <div class="filter-group">
          <mat-form-field appearance="outline" class="filter-field">
            <mat-label>Filter by Status</mat-label>
            <mat-select (selectionChange)="onFilterSelect($event)" [value]="orderParams.filter">
              @for (status of statusOptions; track $index) {
                <mat-option [value]="status">{{ status }}</mat-option>
              }
            </mat-select>
            <mat-icon matSuffix>filter_list</mat-icon>
          </mat-form-field>
        </div>
      </div>
    </div>
  </div>

  <!-- Orders Table Section -->
  <div class="table-section">
    <div class="table-card">
      <div class="card-header">
        <div class="header-info">
          <h2 class="card-title">
            <mat-icon>table_chart</mat-icon>
            Orders Overview
          </h2>
          <p class="card-subtitle">{{ totalItems }} orders found</p>
        </div>
      </div>
      
      <div class="card-content">
        <div class="table-container">
          <table mat-table [dataSource]="dataSource" class="orders-table">
            <!-- ID Column -->
            <ng-container matColumnDef="id">
              <th mat-header-cell *matHeaderCellDef class="column-header">
                <div class="header-content">
                  <mat-icon>tag</mat-icon>
                  <span>Order ID</span>
                </div>
              </th>
              <td mat-cell *matCellDef="let order" class="order-id-cell">
                <span class="order-id">#{{ order.id }}</span>
              </td>
            </ng-container>

            <!-- Buyer Email Column -->
            <ng-container matColumnDef="buyerEmail">
              <th mat-header-cell *matHeaderCellDef class="column-header">
                <div class="header-content">
                  <mat-icon>email</mat-icon>
                  <span>Customer Email</span>
                </div>
              </th>
              <td mat-cell *matCellDef="let order" class="email-cell">
                <span class="customer-email">{{ order.buyerEmail }}</span>
              </td>
            </ng-container>

            <!-- Order Date Column -->
            <ng-container matColumnDef="orderDate">
              <th mat-header-cell *matHeaderCellDef class="column-header">
                <div class="header-content">
                  <mat-icon>schedule</mat-icon>
                  <span>Order Date</span>
                </div>
              </th>
              <td mat-cell *matCellDef="let order" class="date-cell">
                <span class="order-date">{{ order.orderDate | date: 'medium' }}</span>
              </td>
            </ng-container>

            <!-- Total Column -->
            <ng-container matColumnDef="total">
              <th mat-header-cell *matHeaderCellDef class="column-header">
                <div class="header-content">
                  <mat-icon>attach_money</mat-icon>
                  <span>Total</span>
                </div>
              </th>
              <td mat-cell *matCellDef="let order" class="total-cell">
                <span class="order-total">{{ order.total | currency }}</span>
              </td>
            </ng-container>

            <!-- Status Column -->
            <ng-container matColumnDef="status">
              <th mat-header-cell *matHeaderCellDef class="column-header">
                <div class="header-content">
                  <mat-icon>info</mat-icon>
                  <span>Status</span>
                </div>
              </th>
              <td mat-cell *matCellDef="let order" class="status-cell">
                <span class="status-badge" [ngClass]="getStatusClass(order.status)">
                  {{ order.status }}
                </span>
              </td>
            </ng-container>

            <!-- Actions Column -->
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef class="column-header">
                <div class="header-content">
                  <mat-icon>settings</mat-icon>
                  <span>Actions</span>
                </div>
              </th>
              <td mat-cell *matCellDef="let order" class="actions-cell">
                <div class="action-buttons">
                  <button mat-icon-button 
                          color="primary" 
                          (click)="viewOrderDetails(order)" 
                          matTooltip="View Details"
                          class="action-btn view-btn">
                    <mat-icon>visibility</mat-icon>
                  </button>
                  <button mat-icon-button 
                          color="warn" 
                          (click)="openConfirmDialog(order.id)" 
                          matTooltip="Refund Order"
                          [disabled]="order.status === 'Refunded'"
                          class="action-btn refund-btn">
                    <mat-icon>undo</mat-icon>
                  </button>
                </div>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns" class="table-header-row"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="table-row"></tr>

            <!-- Loading and Empty States -->
            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" colspan="6">
                <div class="empty-state">
                  @if (isLoading) {
                    <div class="loading-state">
                      <mat-spinner diameter="40"></mat-spinner>
                      <p>Loading orders...</p>
                    </div>
                  } @else {
                    <div class="no-data-state">
                      <mat-icon>receipt_long</mat-icon>
                      <p>No orders found</p>
                      <span>Try adjusting your filter criteria</span>
                    </div>
                  }
                </div>
              </td>
            </tr>
          </table>
        </div>


      </div>
    </div>
  </div>
</div>
